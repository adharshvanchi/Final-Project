---
title: "Final Project Rough Draft"
author: "Adharsh Vanchinathan"
date: "Due 3/13/2020"
output:
  html_document: default
---


Problem Statement: Is the Internet and the ways to access it detrimental to human wellbeing?

# The Plan

## Introduction
- Provide Engaging and Informative intro to Problem Statement

  The Internet has been a juggernaut of social and cultural change, bringing people together and providing forums and spaces to voice their opinions, display their creative efforts, and even conduct business. However, many of us with access to it take the internet and its effects for granted. Could internet access be a path to more educated, economically powerful country? The effects of internet access and how the access inequality affects countries as a whole has not been extensively studied, and may provide insight into why internet infrastructure is a necessary investment for a 21st century sovereignty. By collecting data on the numbers of non-cellular internet users, % of population that are mobile internet users, % of population who are internet users, and comparing it to their population, GDP, GDP per Capita, and national average learning outcomes, we will attempt to shed more light on the potential of internet access as a key indicator for future success. Using the key internet access indicators, we are able to contrast each country's economic and educational data with their internet access data, providing clear patterns by plotting the data.
- Explain why this problem, data and methods used

- Discuss your approach and analysis and wy it addresses issue
- How analysis helps reader

Gather and tidy up data
- Create df for each country and world data
show world data

select a few countries and show internet availability, mobile phone users, and trnds in economy(GDP, tech market share)
compare countries based on productivity, economic output, and median income against internet availability
Make conclusions on how internet has impacted each country based on these metrics

Use graphs to show relationships

Then use tables to compare and highlight values


-World

  - internet availability % over time
  - Mobile Phone user % over time
  - Tech Market Share over time
  - Social Media membership over time(color by social media app)
  - Population
  - Median Income
  - Digital Media usage over time(USA Data)

-Countries (over time)
  - internet availability (number)
  - internet availability (%)
  - Mobile Phone user % 
  - GDP
  - GDP Per Capita
  - Median Income
  
Discuss each on 1990,1995,2000,2010,2015 against wld_data
  
  

Comparison: Cold War Rivals
- USA
- Russia


Comparison: Countries with similar populations
- South Korea
- Myanmar


Comparison: Countries with similar internet Users
- Canada
- Thailand

Comparison: Countries with similar GDP/Capita

Make conclusions based on comparisons
Summary




```{r setup}
knitr::opts_chunk$set(eval = T)
options(scipen = 999)
# Explain why this package is loaded
suppressPackageStartupMessages(library(tidyverse))

```
# Data:
Num_Users : https://ourworldindata.org/internet#citation
Smartphone_Users: https://ourworldindata.org/internet#citation
Digital Media Usage: https://ourworldindata.org/internet#citation
% internet usage: https://ourworldindata.org/internet#citation
Social Media: https://ourworldindata.org/rise-of-social-media
Population: https://datahub.io/world-bank/sp.pop.totl
GDP: https://datahub.io/core/gdp
National Average Learning Outcome: https://ourworldindata.org/global-education

## Data Prep:

- Source is cited and Hyperlinked
- Source Data is thoroughly explained
  - Who collected it
  - Why it was Collected
  - When it was collected
  - Is there anything wrong or weird about this Data?
- Data Import is logical and explained
- Show final data set(s) in the most condensed form
- Provide a summary for variables of interest
## Tech Data

- Internet users/availability
```{r net_user_load}
net_users_raw <- as.tibble(read.csv(file = "Data/number-of-internet-users-by-country.csv")) %>% rename(Num_Net_Users = Number.of.internet.users..users.)
net_users_wld <- net_users_raw %>% filter(Entity == "World") %>% select(Entity,Year,Num_Net_Users) %>% arrange(Year)
net_users_wld
net_users_raw %>% filter(Entity == "South Korea")

```

- Smartphone users
```{r smartphone_load}
mobile_use_raw <- as.tibble(read.csv(file = "Data/mobile-cellular-subscriptions-per-100-people.csv")) %>% rename(Mobile_Per_100 = Mobile.cellular.subscriptions..per.100.people...per.100.people.) %>% filter(Year > 1989)
mobile_use_wld <- mobile_use_raw %>% filter(Entity == "World") %>% select(Entity, Year, Mobile_Per_100 ) %>% arrange(Year)
mobile_use_raw %>% filter(Entity == "Russia")
```

- Digital media usage
```{r social_media_load}
US_DM_use <- as.tibble(read.csv(file = "Data/daily-hours-spent-with-digital-media-per-adult-user.csv"))
US_DM_use
```

- % of pop internet usage
```{r net_percent_load}
net_per_raw <- as.tibble(read.csv(file = "Data/share-of-individuals-using-the-internet.csv")) %>% rename(Percent_Internet =Individuals.using.the.Internet....of.population.....of.population.)
net_per_wld <- net_per_raw %>% filter(Entity == "World") %>% select(Entity,Year,Percent_Internet) %>% arrange(Year)
net_per_raw %>% filter(Entity == "Russia")

```

- Users by Social Media Platform
```{r sm_user_load}
sm_user_raw <- as.tibble(read.csv(file = "Data/users-by-social-media-platform.csv"))
sm_user <- sm_user_raw %>% rename(Monthly_Users = Monthly.active.users..Statista.and.TNW..2019....MAU.) %>% filter(Entity == "Facebook"| Entity == "Instagram"|Entity == "Reddit"|Entity == "YouTube")
sm_user
```
## Population Data

```{r world_pop_load}
pop_raw <- as.tibble(read.csv(file = "Data/population.csv")) %>% rename(pop = Value) %>% filter(Year > 1989)
wld_pop <- pop_raw %>% filter(Country.Name == "World")
#wld_pop
pop_raw 



```

## Economics and Education

- GDP
```{r GDP_load}
GDP <-read.csv(file = "Data/gdp_csv.csv")%>% rename(GDP = Value) %>% filter(Year > 1989)
GDP_wld<- GDP %>% filter(Country.Name == "World")
GDP %>% filter(Country.Code == "RUS")

```
- Average Learning Outcome(ALO)
```{r ALO_load}
ALO_tbl <- as.tbl(read.csv(file = "Data/average-harmonized-learning-outcome-scores.csv")) %>% filter(Code != "") %>% rename(ALO = Average.harmonised.learning.outcome.score..Altinok..Angrist..and.Patrinos..2018......score..)

```



## Data Analysis:
- Uncover new info that isn't apparent
- Display findings in tables or plots
- Use Graphs to illustrate your primary point
- Use tables to compare and highlight important differences
- Analysis should be thorough and concise
- Easy to Follow



# World Data

## Create DF with World Data(wld_data


```{r wld_data_init}
wld_data <- full_join(wld_pop,net_users_wld,by = "Year") 
wld_data <- wld_data %>% left_join(mobile_use_wld, by = "Year")
wld_data <- wld_data %>% left_join(net_per_wld, by = "Year")
wld_data <- wld_data %>% left_join(GDP_wld, by = "Year") %>% left_join() 
%>% select(Entity = Country.Name.y, Year, pop, Num_Net_Users, Mobile_Per_100, Percent_Internet, GDP) %>% mutate(mobile_pop = (Mobile_Per_100*.01)*pop) 
wld_data %>% head()

```
# Plotting
## Population, Internet users, mobile users

```{r}
ggplot(wld_data)+
  geom_line(aes(Year,pop),color = "Red")+
  geom_line(aes(Year,Num_Net_Users), color = "Green")+
  geom_smooth(aes(Year,mobile_pop), color = "Blue")+
  scale_x_continuous(limits = c(1990,2016), breaks = c(1990,1995,2000,2005,2010,2015))
# Need to facet or Label each graph
# Make it Pretty
  
```

## GDP
```{r}
ggplot(wld_data)+
  geom_line(aes(Year,GDP))+
  labs(title = "World GDP over time", x = "Time(Years)", y = "Nominal GDP (In current USD)")
```

## Internet and Mobile Users (%)

```{r}
mob_100 <- mobile_use_wld %>% select(Year, val = Mobile_Per_100)
per_int <- net_per_wld %>% select(Year,val = Percent_Internet)
ggplot(NULL, aes(Year, val)) + 
  geom_col(aes(fill = "Monthly Mobile Users"), data = mob_100, alpha = 0.5,position = "dodge") +  geom_col(aes(fill = "Percent of Population with Internet"), data = per_int, alpha = 0.5,position = "dodge")+
  scale_y_continuous(limits = c(0,100))
```
```{r}
ggplot(sm_user)+
  geom_line(aes(Year,Monthly_Users))+
  facet_wrap(vars(Entity))
```

## Digital Media Consumption in the US

```{r}
#Digital Media Consumption in US graph(Phone,Laptop,Other)
```


# Country Comparison
For each Country:
Pop
Net_users
Mobile_use_%
net_%
gdp_%





```{r US-data}
US_data <- left_join(pop_raw %>% filter(Country.Name == "United States"),net_users_raw %>% filter(Entity == "United States"),by = "Year") %>% left_join(mobile_use_raw %>% filter(Entity == "United States"), by = "Year") %>% left_join(net_per_raw %>% filter(Entity == "United States")) %>% left_join(GDP) %>% filter(Country.Name == "United States")%>% left_join(ALO_tbl) %>% filter(Entity == "United States") %>% select(Entity,Year,pop,Num_Net_Users,Mobile_Per_100,Percent_Internet,GDP,ALO) %>% mutate(mobile_pop = (Mobile_Per_100*.01)*pop)
US_data
```

```{r RU_data}

RU_data <- left_join(pop_raw %>% filter(Country.Code == "RUS"),net_users_raw %>% filter(Code == "RUS"),by = "Year") %>% left_join(mobile_use_raw %>% filter(Code == "RUS"), by = "Year") %>% left_join(net_per_raw %>% filter(Code == "RUS")) %>% left_join(GDP) %>% filter(Country.Code == "RUS") %>% left_join(ALO_tbl) %>% filter(Code == "RUS") %>% select(Entity = Country.Name,Year,pop,Num_Net_Users,Mobile_Per_100,Percent_Internet,GDP,ALO) %>% mutate(mobile_pop = (Mobile_Per_100*.01)*pop)
RU_data

```


```{r World-US-Russia}

WUR_data <- bind_rows(wld_data,US_data,RU_data) %>% mutate(GDP_Capita = GDP/pop)
WUR_data
```

```{r pop_1}
ggplot(WUR_data %>% filter(Entity != "World"))+
  geom_col(aes(Year,pop,color = Entity), position = "dodge")
```
```{r Internet_1}
ggplot(WUR_data)+
  geom_line(aes(Year,Percent_Internet, color = Entity))
ggplot(WUR_data)+
  geom_line(aes(Year,Mobile_Per_100, color = Entity))

```
```{r GDP_1}
ggplot(WUR_data %>% filter(Entity != "World"))+
  geom_line(aes(Year,GDP_Capita, color = Entity))+

```
```{r}
ggplot(WUR_data %>% filter(Entity != "World"))+
  geom_point(aes(Year,ALO, color = Entity))
  
```



```{r SK_data}
SK_data <- left_join(pop_raw %>% filter(Country.Code == "KOR"),net_users_raw %>% filter(Code == "KOR"),by = "Year") %>% left_join(mobile_use_raw %>% filter(Code == "KOR"), by = "Year") %>% left_join(net_per_raw %>% filter(Code == "KOR")) %>% left_join(GDP) %>% filter(Country.Code == "KOR")%>% left_join(ALO_tbl) %>% filter(Code == "KOR") %>% select(Entity,Year,pop,Num_Net_Users,Mobile_Per_100,Percent_Internet,GDP,ALO) %>% mutate(mobile_pop = (Mobile_Per_100*.01)*pop)
SK_data


```
```{r MM_data}
MM_data <- left_join(pop_raw %>% filter(Country.Code == "MMR"),net_users_raw %>% filter(Code == "MMR"),by = "Year") %>% left_join(mobile_use_raw %>% filter(Code == "MMR"), by = "Year") %>% left_join(net_per_raw %>% filter(Code == "MMR")) %>% left_join(GDP) %>% filter(Country.Code == "MMR") %>% left_join(ALO_tbl) %>% filter(Code == "MMR") %>% select(Entity = Country.Name,Year,pop,Num_Net_Users,Mobile_Per_100,Percent_Internet,GDP,ALO) %>% mutate(mobile_pop = (Mobile_Per_100*.01)*pop) %>% filter(Year >=1999)
MM_data

```

```{r World-SK-Myanmar}

WKM_data <- bind_rows(wld_data,SK_data,MM_data) %>% mutate(GDP_Capita = GDP/pop)
WKM_data
```

```{r pop_2}
ggplot(WKM_data %>% filter(Entity != "World"))+
  geom_line(aes(Year,pop,color = Entity))
```
```{r Internet_2}
ggplot(WKM_data)+
  geom_line(aes(Year,Percent_Internet, color = Entity))
ggplot(WKM_data)+
  geom_line(aes(Year,Mobile_Per_100, color = Entity))

```
```{r GDP_2}
ggplot(WKM_data %>% filter(Entity != "World"))+
  geom_point(aes(Year,GDP_Capita, color = Entity))

```
```{r}
ggplot(WKM_data %>% filter(Entity == "South Korea"))+
  geom_point(aes(Year,ALO, color = Entity))
  
```


```{r CA_data}
CA_data <- left_join(pop_raw %>% filter(Country.Code == "CAN"),net_users_raw %>% filter(Code == "CAN"),by = "Year") %>% left_join(mobile_use_raw %>% filter(Code == "CAN"), by = "Year") %>% left_join(net_per_raw %>% filter(Code == "CAN")) %>% left_join(GDP) %>% filter(Country.Code == "CAN")%>% left_join(ALO_tbl) %>% filter(Code == "CAN") %>% select(Entity,Year,pop,Num_Net_Users,Mobile_Per_100,Percent_Internet,GDP,ALO) %>% mutate(mobile_pop = (Mobile_Per_100*.01)*pop) 
CA_data

```
```{r TL_data}
TL_data <- left_join(pop_raw %>% filter(Country.Code == "THA"),net_users_raw %>% filter(Code == "THA"),by = "Year") %>% left_join(mobile_use_raw %>% filter(Code == "THA"), by = "Year") %>% left_join(net_per_raw %>% filter(Code == "THA")) %>% left_join(GDP) %>% filter(Country.Code == "THA") %>% left_join(ALO_tbl) %>% filter(Code == "THA")%>% select(Entity = Country.Name,Year,pop,Num_Net_Users,Mobile_Per_100,Percent_Internet,GDP,ALO) %>% mutate(mobile_pop = (Mobile_Per_100*.01)*pop) 
TL_data

```

```{r World-Canada-Thailand}

WCT_data <- bind_rows(wld_data,CA_data,TL_data) %>% mutate(GDP_Capita = GDP/pop)
WCT_data
```
```{r pop_2}
ggplot(WCT_data %>% filter(Entity != "World"))+
  geom_col(aes(Year,pop,color = Entity))
```
```{r Internet_2}
ggplot(WCT_data %>% filter(Entity != "World"))+
  geom_line(aes(Year,Num_Net_Users, color = Entity))
ggplot(WCT_data)+
  geom_line(aes(Year,Percent_Internet, color = Entity))
ggplot(WCT_data)+
  geom_line(aes(Year,Mobile_Per_100, color = Entity))


```
```{r GDP_2}
ggplot(WCT_data %>% filter(Entity != "World"))+
  geom_point(aes(Year,GDP_Capita, color = Entity))

```
```{r}
ggplot(WCT_data %>% filter(Entity != "World"))+
  geom_point(aes(Year,ALO, color = Entity))
```



  

## Summary/Conclusion
- Problem Statement
- How it was addressed
- Insight given by analysis
- Implications of findings
- Discuss limitations of findings




